#ifndef MENU_CONTEXT_H
#define MENU_CONTEXT_H

#include <stdint.h>
#include <stdbool.h>

#include "menu_type.h"

typedef struct s_menu_context_t {
    menu_id_t current;
    menu_id_t previous;
    menu_state_t state;
    bool dirty;
    bool invalidate;

    menu_node_value_t *values; ///< Неконстантный массив в динамической памяти. Изменяемые значения листьев
    const menu_node_config_t *configs; ///< Константный массив свойств (конфигураций) листьев
    const menu_node_t *nodes; ///< Константный массив всех нод -- дерево меню
    const menu_id_name_t *id_names; ///< Текстовые название ID меню

    // Буферы для отрисовки (можно вынести в draw модуль)
    char title_buf[LCD_STRING_LEN];
    char value_buf[LCD_STRING_LEN];

    // menu_handle_event_cb_t hande_event_cb; ///< Если установлена, через неё оповещаем, что что-то изменилось
} menu_context_t;

void menu_context_init(menu_context_t *ctx);

char *menu_context_get_title_str(menu_context_t *ctx);
char *menu_context_get_value_str(menu_context_t *ctx);
char *menu_context_set_invalidate(menu_context_t *ctx, bool need_redraw);

#endif /* MENU_CONTEXT_H */
